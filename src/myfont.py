# myfont.py - Enthält beide Font-Groessen im MONO_VLSB Format

import framebuf

# --- FONT 1: 12x16 (24 Bytes/Zeichen) ---

font_12x16_packed = {
    'A': b'\x00\xf8\xfc\x86\x82\x81\x81\x82\x86\xfc\xf8\x00\x00\xff\xff\x01\x01\x01\x01\x01\x01\xff\xff\x00',
    'B': b'\x00\xff\xff\x83\x83\x83\x83\x83\x83\xfe|\x00\x00\xff\xff\xc1\xc1\xc1\xc1\xc1\xc1\xff>\x00',
    'C': b'\x00\xf8\xfc\x06\x03\x03\x03\x03\x06\x0c\x08\x00\x00\x1f?`\xc0\xc0\xc0\xc0`0\x10\x00',
    'D': b'\x00\xff\xff\x03\x03\x03\x03\x03\x03\xfc\xfc\x00\x00\xff\xff\xc0\xc0\xc0\xc0\xc0\xc0??\x00',
    'E': b'\x00\xff\xff\x83\x83\x83\x83\x83\x83\x83\x03\x00\x00\xff\xff\xc1\xc1\xc1\xc1\xc1\xc1\xc1\xc0\x00',
    'I': b'\x00\x03\x03\x03\x03\xff\xff\x03\x03\x03\x03\x00\x00\xc0\xc0\xc0\xc0\xff\xff\xc0\xc0\xc0\xc0\x00',
    'K': b'\x00\xff\xff\x80\xc0`0\x18\x0c\x07\x03\x00\x00\xff\xff\x03\x06\x0c\x180`\xc0\x80\x00',
    'L': b'\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xc0\xc0\xc0\xc0\xc0\xc0\xc0\xc0\x00',
    'M': b'\x00\xff\xfe\x1c8``8\x1c\xfe\xff\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\x00',
    'N': b'\x00\xff\xff\x180`\xc0\x80\x00\xff\xff\x00\x00\xff\xff\x00\x00\x00\x00\x01\x03\xff\xff\x00',
    'O': b'\x00\xf8\xfc\x06\x03\x03\x03\x03\x06\xfc\xf8\x00\x00??@\xc0\xc0\xc0\xe0`??\x00',
    'P': b'\x00\xff\xff\x83\x83\x83\x83\x83\x83\xfe|\x00\x00\xff\xff\x01\x01\x01\x01\x01\x01\x01\x00\x00',
    'R': b'\x00\xff\xff\x83\x83\x83\x83\x83\x83\xfe|\x00\x00\xff\xff\x03\x06\x0c\x180`\xc0\x80\x00',
    'S': b'\x008|F\x83\x83\x03\x03\x06\x0c\x08\x00\x00\x100`\xc0\xc0\xc1\xc1b>\x1c\x00',
    'T': b'\x00\x03\x03\x03\x03\xff\xff\x03\x03\x03\x03\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00',
    'U': b'\x00\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x1f?`\xc0\xc0\xc0\xc0`?\x1f\x00',
    'W': b'\x00\xff\xff\x00\x00\x80\x80\x00\x00\xff\xff\x00\x00\xff\x7f\x0e\x07\x01\x01\x07\x0e\x7f\xff\x00',
    '0': b'\x00\xf8\xfc\x06\x03\x03\x03\x03\x06\xfc\xf8\x00\x00\x1f?`\xc0\xc0\xc0\xc0`?\x1f\x00',
    '1': b'\x00\x00\x08\x0c\x06\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00',
    '2': b'\x00\x08\x0c\x06\x03\x03\x03\x03\x86\xfcx\x00\x00\xe0\xf0\xd0\xc8\xcc\xc6\xc3\xc1\xc0\x00\x00',
    '3': b'\x00\x08\x0c\x06\x03\x83\x83\x83\x86\xfcx\x00\x00\x100`\xc0\xc1\xc1\xc1a?\x1e\x00',
    '4': b'\x00\x80\xc0\xe0\xb0\x98\x8c\x86\x82\xff\xff\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\xff\xff\x00',
    '5': b'\x00\xff\xff\xc3\xc3\xc3\xc3\xc3\xc3\xc3\x00\x00\x00\x100`\xc0\xc0\xc0\xc0`?\x1f\x00',
    '6': b'\x00\xf8\xfc\xc6\xc3\xc3\xc3\xc3\xc6\xcc\x08\x00\x00\x1e?a\xc1\xc0\xc0\xc1a?\x1e\x00',
    '7': b'\x00\x03\x03\x03\x03\x03\x83\xe3{\x1f\x07\x00\x00\x00\x80\xe0x\x1e\x07\x01\x00\x00\x00\x00',
    '8': b'\x008\xfc\xc6\xc3\x83\x83\xc3\xc6\xfc8\x00\x00\x1e?a\xc1\xc0\xc0\xc1a?\x1e\x00',
    '9': b'\x008\xfc\xc6\xc3\x83\x83\xc3\xc6\xfc8\x00\x00\x100a\xc1\xc0\xc0\xc1a?\x1e\x00',
    '.': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf0\xf0\x00\x00\x00\x00\x00\x00\x00',
    '-': b'\x00\x80\x80\x80\x80\x80\x80\x80\x80\x80\x80\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00',
    ' ': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',
}

# --- FONT 2: 16x21 (48 Bytes/Zeichen) ---

font_16x21_packed = {
    'A': b'\x00\xf0\xf0\xfc\x0e\x02\x02\x01\x01\x02\x02\x0e\xfc\xf0\xf0\x00\x00\xff\xff\xff\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\xff\xff\xff\x00\x00\x1f\x1f\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x1f\x1f\x1f\x00',
    'B': b'\x00\xff\xff\xff\x03\x03\x03\x03\x03\x03\x03\x03\xfe\xfc\xfc\x00\x00\xff\xff\xff\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\xff\xf1\xf1\x00\x00\x1f\x1f\x1f\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1f\x03\x03\x00',
    'C': b'\x00\xf0\xf0\xfc\x0e\x03\x03\x03\x03\x03\x03\x0e\x1c\x10\x10\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x03\x0e\x1c\x1c\x1c\x1c\x1c\x1c\x0e\x03\x01\x01\x00',
    'D': b'\x00\xff\xff\xff\x03\x03\x03\x03\x03\x03\x03\x03\xfc\xfc\xfc\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x1f\x1f\x1f\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x03\x03\x03\x00',
    'E': b'\x00\xff\xff\xff\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x00\x00\xff\xff\xff\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x00\x00\x00\x00\x1f\x1f\x1f\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x00',
    'I': b'\x00\x03\x03\x03\x03\x03\x03\xff\xff\x03\x03\x03\x03\x03\x03\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x1c\x1c\x1c\x1c\x1c\x1c\x1f\x1f\x1c\x1c\x1c\x1c\x1c\x1c\x00',
    'K': b'\x00\xff\xff\xff\x00\x00\x00\x80\xe0pp\x1c\x0f\x03\x03\x00\x00\xff\xff\xff\x1ess\xe1\x80\x00\x00\x00\x00\x00\x00\x00\x00\x1f\x1f\x1f\x00\x00\x00\x00\x01\x03\x03\x0e\x1c\x10\x10\x00',
    'L': b'\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1f\x1f\x1f\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x00',
    'M': b'\x00\xff\xff\xfe|\xf0\xf0\x80\x80\xf0\xf0|\xfe\xff\xff\x00\x00\xff\xff\xff\x00\x00\x00\x01\x01\x00\x00\x00\xff\xff\xff\x00\x00\x1f\x1f\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x1f\x1f\x1f\x00',
    'N': b'\x00\xff\xff\xffp\xe0\xe0\x80\x00\x00\x00\x00\xff\xff\xff\x00\x00\xff\xff\xff\x00\x00\x00\x01\x03\x0e\x0e\x1c\xff\xff\xff\x00\x00\x1f\x1f\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x1f\x1f\x1f\x00',
    'O': b'\x00\xf0\xf0\xfc\x0e\x03\x03\x03\x03\x03\x03\x0e\xfc\xf0\xf0\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x03\x03\x03\x0c\x1c\x1c\x1c\x1c\x1e\x1e\x0e\x03\x03\x03\x00',
    'P': b'\x00\xff\xff\xff\x03\x03\x03\x03\x03\x03\x03\x03\xfe\xfc\xfc\x00\x00\xff\xff\xff\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0f\x01\x01\x00\x00\x1f\x1f\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',
    'R': b'\x00\xff\xff\xff\x03\x03\x03\x03\x03\x03\x03\x03\xfe\xfc\xfc\x00\x00\xff\xff\xff\x1err\xe2\x82\x02\x02\x02\x03\x01\x01\x00\x00\x1f\x1f\x1f\x00\x00\x00\x00\x01\x03\x03\x0e\x1c\x10\x10\x00',
    'S': b'\x00\xf0\xf0\xfc\x0e\x03\x03\x03\x03\x03\x03\x0e\x1c\x10\x10\x00\x00\x00\x00\x01\x01\x02\x02\x02\x0c\x0c\x0c\x10\xf0\xe0\xe0\x00\x00\x01\x01\x03\x0e\x1c\x1c\x1c\x1c\x1c\x1c\x0e\x03\x01\x01\x00',
    'T': b'\x00\x03\x03\x03\x03\x03\x03\xff\xff\x03\x03\x03\x03\x03\x03\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1f\x1f\x00\x00\x00\x00\x00\x00\x00',
    'U': b'\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x01\x01\x03\x0e\x1c\x1c\x1c\x1c\x1c\x1c\x0e\x03\x01\x01\x00',
    'W': b'\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\xff\xff\xff\xf0||\x0e\x0e||\xf0\xff\xff\xff\x00\x00\x1f\x1f\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x0f\x1f\x1f\x00',
    '0': b'\x00\xf0\xf0\xfc\x0e\x03\x03\x03\x03\x03\x03\x0e\xfc\xf0\xf0\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x01\x01\x03\x0e\x1c\x1c\x1c\x1c\x1c\x1c\x0e\x03\x01\x01\x00',
    '1': b'\x00\x00\x00\x10\x1c\x0e\x0e\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1f\x1f\x00\x00\x00\x00\x00\x00\x00',
    '2': b'\x00\x10\x10\x1c\x0e\x03\x03\x03\x03\x03\x03\x0e\xfc\xf0\xf0\x00\x00\x00\x00\x00\x00\x80\x80\xe0p\x1c\x1c\x0e\x03\x01\x01\x00\x00\x1e\x1e\x1f\x1d\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x1c\x00\x00\x00',
    '3': b'\x00\x10\x10\x1c\x0e\x03\x03\x03\x03\x03\x03\x0e\xfc\xf0\xf0\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x0e\x0e\x0e\x0e\xff\xf1\xf1\x00\x00\x01\x01\x03\x0e\x1c\x1c\x1c\x1c\x1c\x1c\x0e\x03\x01\x01\x00',
    '4': b'\x00\x00\x00\x00\x80\xe0\xe0p\x1c\x0e\x0e\x02\xff\xff\xff\x00\x00\x0e\x0e\x0f\x0f\x0e\x0e\x0e\x0e\x0e\x0e\x0e\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1f\x1f\x1f\x00',
    '5': b'\x00\xff\xff\xff\x03\x03\x03\x03\x03\x03\x03\x03\x03\x00\x00\x00\x00\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\xff\xfc\xfc\x00\x00\x01\x01\x03\x0e\x1c\x1c\x1c\x1c\x1c\x1c\x0e\x03\x01\x01\x00',
    '6': b'\x00\xf0\xf0\xfc\x0e\x03\x03\x03\x03\x03\x03\x0e\x1c\x10\x10\x00\x00\xf3\xf3\xff\x0f\x0f\x0f\x03\x03\x0f\x0f\x0f\xff\xf0\xf0\x00\x00\x01\x01\x03\x0e\x1c\x1c\x1c\x1c\x1c\x1c\x0e\x03\x01\x01\x00',
    '7': b'\x00\x03\x03\x03\x03\x03\x03\x03\x03\x83\x83\xf3\x7f\x0f\x0f\x00\x00\x00\x00\x00\x00\x80\x80\xf0~\x0f\x0f\x01\x00\x00\x00\x00\x00\x00\x00\x10\x1e\x0f\x0f\x01\x00\x00\x00\x00\x00\x00\x00\x00',
    '8': b'\x00\xf0\xf0\xfc\x0e\x03\x03\x03\x03\x03\x03\x0e\xfc\xf0\xf0\x00\x00\xf0\xf0\xff\x0f\x0f\x0f\x02\x02\x0f\x0f\x0f\xff\xf0\xf0\x00\x00\x01\x01\x03\x0e\x1c\x1c\x1c\x1c\x1c\x1c\x0e\x03\x01\x01\x00',
    '9': b'\x00\xf0\xf0\xfc\x0e\x03\x03\x03\x03\x03\x03\x0e\xfc\xf0\xf0\x00\x00\x00\x00\x03\x0f\x0f\x0f\x02\x02\x0f\x0f\x0f\xff\xf0\xf0\x00\x00\x01\x01\x03\x0e\x1c\x1c\x1c\x1c\x1c\x1c\x0e\x03\x01\x01\x00',
    '.': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1f\x1f\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00',
    '-': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',
    ' ': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00',
}


# --- FONT KLASSE ZUR VERWENDUNG MIT FRAMEBUF ---

class MyFont:
    """
    Kombinierter Font für MicroPython framebuf.
    Initialisierung mit der gewünschten Größe ('small' oder 'large').
    """

    def __init__(self, size='small'):
        self.size = size.lower()
        if self.size == 'small':
            self.font_data = font_12x16_packed
            self.width = 12
            self.height = 16
            self.byte_count = 24
        elif self.size == 'large':
            self.font_data = font_16x21_packed
            self.width = 16
            self.height = 21
            self.byte_count = 48
        else:
            raise ValueError("Ungültige Font-Größe. Wähle 'small' (12x16) oder 'large' (16x21).")

        # Prüfe, ob alle Daten in der richtigen Größe vorliegen
        for char, data in self.font_data.items():
            if len(data) != self.byte_count:
                raise ValueError(f"Datenfehler für '{char}': Erwartet {self.byte_count} Bytes, fand {len(data)}.")


    # framebuf-kompatible Methoden
    
    def get_ch(self, char_code):
        """
        Gibt die Rohdaten, Breite, Höhe und Format für framebuf zurück.
        char_code ist der Integer-ASCII-Code.
        """
        try:
            char = chr(char_code)
            data = self.font_data.get(char, self.font_data[' ']) # Fallback auf Leerzeichen
            
            # WICHTIG: Framebuf erwartet ein Speicher-Array (z.B. bytes oder bytearray)
            # data ist bereits das Byte-Objekt (b'\x..')
            
            return data, self.width, self.height, framebuf.MONO_VLSB
            
        except KeyError:
            # Sollte nicht passieren, da wir Fallback auf Leerzeichen haben
            return self.font_data[' '], self.width, self.height, framebuf.MONO_VLSB

    # Optional: Eine Methode zur Berechnung der Textbreite
    def get_text_width(self, text):
        return len(text) * self.width

# --- ANWENDUNGSBEISPIEL ---
# import ssd1306 # Oder ihr spezifisches Display-Modul
# import machine
# i2c = machine.I2C(0, scl=machine.Pin(17), sda=machine.Pin(16))
# display = ssd1306.SSD1306_I2C(128, 64, i2c)

# # Font initialisieren
# small_font = MyFont(size='small')
# large_font = MyFont(size='large')

# # Text zeichnen (Beispiel)
# # display.text('HALLO', 10, 10, 1, font=small_font)
# # display.text('GROSS', 10, 30, 1, font=large_font)
# # display.show()